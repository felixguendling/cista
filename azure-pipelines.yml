jobs:
  - job: msvc
    strategy:
      matrix:
        REL:
          BUILD_TYPE: Release
        DBG:
          BUILD_TYPE: Debug
    pool:
      vmImage: windows-2019
    variables:
      CXXFLAGS: /std:c++latest
    steps:
    - task: CMake@1
      displayName: 'CMake'
      inputs:
        cmakeArgs: '-G "Visual Studio 16 2019" -A x64 ..'
    - task: MSBuild@1
      displayName: 'Build Solution'
      inputs:
        solution: build/cista.sln
        msbuildArguments: '/m /p:Configuration=$(BUILD_TYPE)'
    - script: cista-test
      displayName: 'Run Tests'
      workingDirectory: build\$(BUILD_TYPE)
